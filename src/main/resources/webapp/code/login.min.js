/*! sfera-webapp - v0.0.2 - 10-11-2015 */
function HTTPReq(a){function b(){h&&(clearTimeout(h),h=null),e=-1,f.abort(),d(i.ERROR_MAXWAITTIME),i.init()}function c(){if(null!=f.readyState){switch(f.readyState){case 0:case 1:return;case 2:case 3:return;case 4:}if(h&&(clearTimeout(h),h=null),1==e){if(e=2,200!=f.status)return void d(i.ERROR_CONNECTION);var a="";try{a=f.responseText}catch(b){return void d(i.ERROR_GENERAL)}return 0==a.indexOf("authenticate")||0==a.indexOf("logout")?void d(i.ERROR_LOGOUT):0==a.indexOf("lock")?void d(i.ERROR_LOCK):"noaccess"==a?void d(i.ERROR_NOACCESS):void(i.onLoaded&&i.onLoaded())}}}function d(a){switch(a){case i.ERROR_CONNECTION:if(i.onConnectionError)return void i.onConnectionError();break;case i.ERROR_LOGOUT:if(i.onAuthenticate)return void i.onAuthenticate(!1);break;case i.ERROR_LOCK:if(i.onAuthenticate)return void i.onAuthenticate(!0);break;case i.ERROR_NOACCESS:if(i.onNoAccess)return void i.onNoAccess()}return i.retryOnErrorDelay&&(!i.maxRetries||i.retries<i.maxRetries)&&(i.retries++,i.onRetry&&i.onRetry(),i.retryOnErrorDelay)?void i.repeat(i.retryOnErrorDelay):void(i.onError&&i.onError(a))}a||(a="GET");var e,f=null,g=null;this.url="",this.onLoaded=null,this.onStop=null,this.onRetry=null,this.onError=null,this.onRequest=null,this.onConnectionError=null,this.onAuthenticate=null,this.onNoAccess=null,this.maxWaitingTime=0;var h=null;this.retryOnErrorDelay=0,this.maxRetries=0,this.retries=0;var i=this;this.ERROR_GENERAL=0,this.ERROR_CONNECTION=1,this.ERROR_MAXWAITTIME=2,this.ERROR_LOGOUT=3,this.ERROR_LOCK=4,this.ERROR_NOACCESS=5,this.init=function(){e=0,window.XMLHttpRequest?(f=new XMLHttpRequest,f.onreadystatechange=c):window.ActiveXObject&&(f=new ActiveXObject("Microsoft.XMLHTTP"),f&&(f.onreadystatechange=c))},this.open=function(c,j){if(1==e&&i.stop(),e=0,c&&(i.url=c,i.retries=0),g&&(clearTimeout(g),g=null),h&&(clearTimeout(h),h=null),j)return void(g=setTimeout(i.open,j));f||i.init(),e=1,i.onRequest&&i.onRequest();try{f.open(a,i.url,!0)}catch(k){return void d(i.ERROR_GENERAL)}f.send(),i.maxWaitingTime&&(h=setTimeout(b,i.maxWaitingTime))},this.stop=function(){(1==e||g)&&this.onStop&&this.onStop(1==e),1==e&&(e=-1,f.abort(),this.init()),g&&(clearTimeout(g),g=null),h&&(clearTimeout(h),h=null),e=0},this.repeat=function(a){this.open(null,a)},this.getResponseText=function(){var a="";try{return a=f.responseText}catch(b){return null}},this.getResponseXML=function(){var a="";try{return a=f.responseXML}catch(b){return null}},this.isReady=function(){return 1!=e}}function doLogin(){resetCheck();var a=document.getElementById("user").value,b=document.getElementById("password").value;req.open("/api/login?user="+a+"&password="+b,100)}function checkLogin(){}function resetCheck(){clearTimeout(checkTimeout),checkTimeout=setTimeout(checkLogin,checkMs)}var checkTimeout=null,checkMs=500,req=new HTTPReq("GET"),what="login";req.onLoaded=function(){clearTimeout(checkTimeout),window.location.replace("/"+interf)},req.onError=function(){resetCheck()},window.onload=function(){resetCheck()};