/*! sfera-webapp - v0.0.2 - 10-11-2015 */
(function(){var a=this,b=b||{VERSION:"0.1.0",client:null,urls:{get:function(a){switch(a){case"dictionary":return b.client.name+"/dictionary.xml";case"index":return b.client.name+"/index.xml";case"subscribe":return"subscribe?id="+(b.client.net.subscribeId?b.client.net.subscribeId+"&":"")+"nodes=*";case"state":return"state/"+b.client.net.subscribeId+"?ts="+b.client.stateTs;case"command":return"command";case"event":return"event";case"websocket":return("https:"==b.Browser.getLocation().protocol?"wss:":"ws:")+"//localhost:8080/api/websocket"}}}};b.Behaviors={},b.Behaviors.Visibility=function(){this.attrDefs.visible={type:"boolean",compile:function(){this.changed=!1,this.value=!(!this.source||"false"==this.source),this.update()},update:function(){this.component.element.style.display=this.value?"inline":"none"}}},b.Behaviors.Position=function(){this.attrDefs.x={type:"int",update:function(){this.component.element.style.left=this.value+"px"}},this.attrDefs.y={type:"int",update:function(){this.component.element.style.top=this.value+"px"}}},b.Behaviors.Size=function(){this.attrDefs.width={type:"int",update:function(){this.component.element.style.width=this.value+"px"}},this.attrDefs.height={type:"int",update:function(){this.component.element.style.height=this.value+"px"}}},b.Behaviors.Label=function(){this.attrDefs.label={type:"string",update:function(){this.component.element.innerHTML=this.value}},this.attrDefs.color={type:"string",update:function(){this.component.element.style.color=this.value}},this.attrDefs.fontSize={type:"int",update:function(){this.component.element.style.fontSize=this.value+"px"}},this.attrDefs.textAlign={type:"string",update:function(){this.component.element.style.textAlign=this.value}}},b.Compiler=function(a){this.client=a,this.createComponent=function(a,c){var d=b.Components.getInstance(a,c);return d},this.compileXMLNode=function(c){if(1==c.nodeType){var d,e,f={};for(d=0;d<c.attributes.length;d++)e=c.attributes[d],f[b.Utils.dashToCamel(e.name)]=e.value;var g=this.createComponent(c.nodeName,f);if(g){a.indexComponent(g);var h,i=c.childNodes;for(d=0;d<i.length;d++)h=this.compileXMLNode(i[d]),h&&g.addChild(h)}return g}return null},this.compileXML=function(a){return this.compileXMLNode(a.documentElement)},this.compileString=function(a){parser=new DOMParser,xmlDoc=parser.parseFromString(txt,"text/xml"),this.compileXML(xmlDoc)},this.compileDictionary=function(a){var c=a.documentElement;if(c&&1==c.nodeType){var d,e,f,g,h,i=c.childNodes;for(f=0;f<i.length;f++)if(1==i[f].nodeType)switch(i[f].tagName){case"skin":break;case"components":for(d=i[f].childNodes,g=0;g<d.length;g++)if(1==d[g].nodeType)for(e=d[g].childNodes,h=0;h<e.length;h++)switch(e[h].tagName){case"src":b.Components.setSource(d[g].tagName,b.Utils.getCDATA(e[h]));break;case"_lan":b.Components.setLanguage(d[g].tagName,b.Utils.getCDATA(e[h]))}}}},this.compilePropertyValue=function(a){function b(a){switch(a){case"one":return"1";case"two":return"2"}return""}var c;c="<div>{{one}}</div><p></p><br /><div>{{two}}</div>";var d=/\{\{([^}]*)\}\}/;c="<div><!--sfera><--!></div><p></p><br /><div>{{two}}</div>",c.replace(d,function(a,c){return b(c)})}},b.Attribute=function(a,b){this.type="string",this.changed=!1,this.source="",this.value="",this.component=a;for(var c in b)switch(c){case"type":case"source":case"value":this[c]=b[c];break;case"set":case"get":case"compile":case"update":this[c]=b[c].bind(this)}},b.Attribute.prototype={set:function(a,b){this.changed=!0,this.source=a,b||this.compile()},get:function(){return this.value},compile:function(){this.changed=!1,this.value=this.source,this.update()},update:function(){}},b.ComponentManager=function(a){this.client=a;var b=new function(){function a(a,b,c){b[a[c]]||(b[a[c]]=[]),b[a[c]].push(a)}function b(a,b){return a[b]?a[b]:[]}this.all=[];var c={},d={},e={};this.add=function(b){this.all.push(b),a(b,e,"type"),b.id&&a(b,c,"id"),b.address&&a(b,d,"address")},this.getByType=function(a){return b(e,a)},this.getByAddress=function(a){return b(d,a)},this.getById=function(a){return b(c,a)}};this.index=function(a){b.add(a)},this.getObjById=function(a){return b.getById(a)[0]},this.getObjsById=function(a){return b.getById(a)},this.getObjsByType=function(a){return b.getByType(a)},this.getObjValue=function(a){var c=b.getById(a)[0];return c&&c.getValue?c.getValue():null},this.getFavPages=function(){for(var a=[],b=this.getObjsByType("link"),c=0;c<b.length;c++)a.push(b[c].target);return a=a.unique().sort()}},b.Components=new function(){this.setSource=function(a,b){var c=this.getClass(a);c.prototype.source=b},this.getClassName=function(a){return a[0].toUpperCase()+a.substr(1)},this.getClass=function(a){return b.Components[this.getClassName(a)]},this.getInstance=function(a,b){var c=this.getClass(a);if(null==c)return null;var d=new c({attributes:b});return d},this.create=function(a,c){b.Components[a]=function(c){if(c.element)this.element=element;else{var d=document.createElement("div");d.innerHTML=this.source,this.element=b.Utils.getFirstChildNodeOfType(d,1),this.element.controller=this,this.element.setAttribute("data-controller",a)}this.attributes={};for(var e in this.attrDefs)this.attributes[e]=new b.Attribute(this,this.attrDefs[e]);if(c.attributes)for(var e in c.attributes)this.setAttribute(e,c.attributes[e]);this["super"]("_Base","init"),this.init()};var d=b.Components[a];d.displayName="Sfera.Component."+a,c["extends"]||(c["extends"]="_Base");var e=b.Components[c["extends"]].prototype;d.prototype=Object.create(e),d.prototype.constructor=d,d.prototype.type=a,d.prototype.attrDefs={};for(var f in e.attrDefs)d.prototype.attrDefs[f]=e.attrDefs[f];for(var g in c)switch(g){case"behaviors":for(var h,i=0;i<c.behaviors.length;i++)h=b.Behaviors[c.behaviors[i]],h.call(d.prototype);break;case"attributes":for(var j in c.attributes)d.prototype.attrDefs[j]=c.attributes[j];break;default:d.prototype[g]=c[g],"function"==typeof d.prototype[g]&&(d.prototype[g].displayName="Sfera.Components."+a+"."+g)}}},b.Client=function(a){function c(){if(g){var a,b,c=parseInt(g.getAttribute("width")),d=parseInt(g.getAttribute("height"));if(window.innerWidth?(a=window.innerWidth,b=window.innerHeight):document.documentElement&&document.documentElement.clientWidth?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body.clientWidth?(a=document.body.clientWidth,b=document.body.clientHeight):(a=0,b=0),a>0){var e=a>c?(a-c)/2:0,f=b>d?(b-d)/2:0;g.element.style.display="none",g.element.style.left=e+"px",g.element.style.top=f+"px",g.element.style.display="block"}}}b.client=this,this.config=null,this.isBooted=!1,this.isRunning=!1,this.device=null,this.net=null,this.compiler=null,this.components=null,this.input=null,this.debug=null;this.cPage=null;var d=0,e={name:b.Browser.getLocation()["interface"],enableDebug:!0,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null};a||(a={});for(var f in a)"undefined"!=typeof a[f]?this[f]=e[f]:this[f]=a[f];var g;this.boot=function(e){this.isBooted||(a&&a.timestamp&&(d=a.timestamp),b.client=this,this.device=b.Device,this.browser=b.Browser,this.isBooted=!0,this.net=new b.Net(this),this.compiler=new b.Compiler(this),this.components=new b.ComponentManager(this),this.name=a["interface"],this.debug=b.Debug,this.debug.boot(),window.focus&&window.focus(),this.showDebugHeader(),this.net.boot(),window.onresize=c,delete a)},this.showDebugHeader=function(){var a=b.VERSION,c=2,d="hello";if(this.device.chrome){for(var e=["%c %c %c Sfera v"+a+" | "+d+"  %c %c %c http://sfera.cc %c♥%c♥%c♥","background: #9854d8","background: #6c2ca7","color: #ffffff; background: #450f78;","background: #6c2ca7","background: #9854d8","background: #ffffff"],f=0;3>f;f++)c>f?e.push("color: #ff2424; background: #fff"):e.push("color: #959595; background: #fff");console.log.apply(console,e)}else window.console&&console.log("Sfera v"+a+" | "+d+" | http://sfera.cc")},this.destroy=function(){this.input.destroy(),this.input=null,this.isBooted=!1,b.CLIENTS[this.id]=null},this.openIndex=function(a,b){},this.openDictionary=function(a,b){},this.onUpdateDictionary=function(a){this.compiler.compileDictionary(a)},this.onUpdateIndex=function(a){var b=this.compiler.compileXML(a);document.getElementById("sfera").appendChild(b.element),this.start()},this.start=function(){this.browser.start(),g=this.components.getObjsByType("Interface")[0],c()},this.indexComponent=function(a){this.components.index(a)},this.setAttribute=function(a,b,c){for(var d=this.components.getObjsById(a),e=0;e<d.length;e++)d[e].setAttribute(b,c)},this.showPage=function(a){-1==a.indexOf(":")&&(a="page:"+a),this.cPage&&this.cPage.setAttribute("visible",!1);var c=this.components.getObjById(a);c?(c.setAttribute("visible",!0),this.cPage=c,b.Browser.updateUrl(a,c.getAttribute("title"))):console.log("page not found: "+a)},this.commandQueue=[],this.sendCommand=function(a,b){var c=(new Date).getTime(),d={command:a,tag:c,sender:b};return this.commandQueue.push(d),this.net.sendCommand(d),c},this.eventQueue=[],this.sendEvent=function(a,b,c){var d=(new Date).getTime(),e={id:"webapp.ui."+a,value:b,tag:d,sender:c};return this.eventQueue.push(e),this.net.sendEvent(e),d},this.onCommand=function(a){},this.onEvent=function(a){for(var c in a.nodes){var e=c.split(".");switch(e[0]){case"ui":if("set"==e[1]){e=e.slice(2);for(var f=e.pop(),g=this.components.getObjsById(e.join(".")),h=0;h<g.length;h++)g[h].setAttribute(f,a.nodes[c])}break;case"webapp":"interface"==e[1]&&e[2]==this.name&&"update"==e[3]&&a.nodes[c]!=d&&(d=a.nodes[c],b.Browser.reload())}}},this.onStateUpdate=function(){}},b.Debug=new function(){function a(a){e.style.display=a?"block":"none",a&&f.initPane()}function c(a){var b=a.keyCode;if(13==b);else if(event.keyCode>=65&&event.keyCode<=90)switch(String.fromCharCode(event.keyCode)){case"D":f.toggle()}return!0}var d,e,f=this;document.addEventListener("keydown",c,!1),this.visible=!1,this.boot=function(){d=document.getElementById("debugLog"),e=document.getElementById("debug"),a(!1)},this.toggle=function(){this.visible=!this.visible,a(this.visible)};var g=0;this.log=function(a,c){g++;var e=b.Utils.getDate();a=e+" - "+a;var f='<label class="menu_label" for="debugEntry'+g+'">'+a+'</label><input type="checkbox" id="debugEntry'+g+'" /><div class="arrow"></div><ol><li><textarea style="width:500px; height:200px">'+c+"</textarea></li></ol>",h=document.createElement("div");h.innerHTML=f,d.appendChild(h)}},b.Debug.initPane=function(){function a(a,b,c,d,e){a.style.left=b+"px",a.style.top=c+"px",a.style.width=d+"px",a.style.height=e+"px"}function b(){a(E,t.left,t.top,t.width,t.height),E.style.opacity=0}function c(a){g(a.touches[0]),a.preventDefault()}function d(a){j(a.touches[0])}function e(a){0==a.touches.length&&l(a.changedTouches[0])}function f(a){g(a),a.preventDefault()}function g(a){i(a);var b=m||n||p||o;A={x:u,y:v,cx:a.clientX,cy:a.clientY,w:t.width,h:t.height,isResizing:b,isMoving:!b&&h(),onTopEdge:p,onLeftEdge:o,onRightEdge:m,onBottomEdge:n}}function h(){return u>0&&u<t.width&&v>0&&v<t.height&&30>v}function i(a){t=C.getBoundingClientRect(),u=a.clientX-t.left,v=a.clientY-t.top,p=z>v,o=z>u,m=u>=t.width-z,n=v>=t.height-z,q=window.innerWidth-z,r=window.innerHeight-z}function j(a){i(a),F=a,B=!0}function k(){if(requestAnimationFrame(k),B){if(B=!1,A&&A.isResizing){if(A.onRightEdge&&(C.style.width=Math.max(u,w)+"px"),A.onBottomEdge&&(C.style.height=Math.max(v,x)+"px"),A.onLeftEdge){var c=Math.max(A.cx-F.clientX+A.w,w);c>w&&(C.style.width=c+"px",C.style.left=F.clientX+"px")}if(A.onTopEdge){var d=Math.max(A.cy-F.clientY+A.h,x);d>x&&(C.style.height=d+"px",C.style.top=F.clientY+"px")}return b(),void(D.style.width=C.style.width)}return A&&A.isMoving?(t.top<y||t.left<y||t.right>window.innerWidth-y||t.bottom>window.innerHeight-y?(a(E,0,0,window.innerWidth,window.innerHeight),E.style.opacity=.2):t.top<z?(a(E,0,0,window.innerWidth,window.innerHeight/2),E.style.opacity=.2):t.left<z?(a(E,0,0,window.innerWidth/2,window.innerHeight),E.style.opacity=.2):t.right>q?(a(E,window.innerWidth/2,0,window.innerWidth/2,window.innerHeight),E.style.opacity=.2):t.bottom>r?(a(E,0,window.innerHeight/2,window.innerWidth,window.innerWidth/2),E.style.opacity=.2):b(),s?(a(C,F.clientX-s.width/2,F.clientY-Math.min(A.y,s.height),s.width,s.height),void(D.style.width=C.style.width)):(C.style.top=F.clientY-A.y+"px",C.style.left=F.clientX-A.x+"px",void(D.style.width=C.style.width))):void(m&&n||o&&p?C.style.cursor="nwse-resize":m&&p||n&&o?C.style.cursor="nesw-resize":m||o?C.style.cursor="ew-resize":n||p?C.style.cursor="ns-resize":h()?C.style.cursor="move":C.style.cursor="default")}}function l(c){if(i(c),A&&A.isMoving){var d={width:t.width,height:t.height};t.top<y||t.left<y||t.right>window.innerWidth-y||t.bottom>window.innerHeight-y?(a(C,0,0,window.innerWidth,window.innerHeight),s=d):t.top<z?(a(C,0,0,window.innerWidth,window.innerHeight/2),s=d):t.left<z?(a(C,0,0,window.innerWidth/2,window.innerHeight),s=d):t.right>q?(a(C,window.innerWidth/2,0,window.innerWidth/2,window.innerHeight),s=d):t.bottom>r?(a(C,0,window.innerHeight/2,window.innerWidth,window.innerWidth/2),s=d):s=null,b()}A=null}var m,n,o,p,q,r,s,t,u,v,w=60,x=40,y=-10,z=10,A=null,B=!1,C=document.getElementById("debugPane"),D=document.getElementById("debugTitle"),E=document.getElementById("debugGhost");D.style.width=C.style.width,C.addEventListener("mousedown",f),document.addEventListener("mousemove",j),document.addEventListener("mouseup",l),C.addEventListener("touchstart",c),document.addEventListener("touchmove",d),document.addEventListener("touchend",e);var F;k()},b.Log=new function(){this.ALL=1,this.DEBUG=2,this.INFO=3,this.WARN=4,this.ERROR=5,this.FATAL=6,this.OFF=7;var a=this.WARN;this.setLevel=function(b){a=b}},b.Signal=function(){},b.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!0,validateListener:function(a,b){if("function"!=typeof a)throw new Error("Sfera.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))},_registerListener:function(a,c,d,e,f){var g,h=this._indexOfListener(a,d);if(-1!==h){if(g=this._bindings[h],g.isOnce()!==c)throw new Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.")}else g=new b.SignalBinding(this,a,c,d,e,f),this._addBinding(g);return this.memorize&&this._prevParams&&g.execute(this._prevParams),g},_addBinding:function(a){this._bindings||(this._bindings=[]);var b=this._bindings.length;do b--;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){if(!this._bindings)return-1;void 0===b&&(b=null);for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){this.validateListener(a,"add");var d=[];if(arguments.length>3)for(var e=3;e<arguments.length;e++)d.push(arguments[e]);return this._registerListener(a,!1,b,c,d)},addOnce:function(a,b,c){this.validateListener(a,"addOnce");var d=[];if(arguments.length>3)for(var e=3;e<arguments.length;e++)d.push(arguments[e]);return this._registerListener(a,!0,b,c,d)},remove:function(a,b){this.validateListener(a,"remove");var c=this._indexOfListener(a,b);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(a){if(void 0===a&&(a=null),this._bindings){for(var b=this._bindings.length;b--;)a?this._bindings[b].context===a&&(this._bindings[b]._destroy(),this._bindings.splice(b,1)):this._bindings[b]._destroy();a||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var a,b=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=b),c){a=this._bindings.slice(),this._shouldPropagate=!0;do c--;while(a[c]&&this._shouldPropagate&&a[c].execute(b)!==!1)}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll(),this._bindings=null,this._prevParams&&(this._prevParams=null)},toString:function(){return"[Sfera.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},Object.defineProperty(b.Signal.prototype,"boundDispatch",{get:function(){var a=this;return this._boundDispatch||(this._boundDispatch=function(){return a.dispatch.apply(a,arguments)})}}),b.Signal.prototype.constructor=b.Signal,b.SignalBinding=function(a,b,c,d,e,f){this._listener=b,c&&(this._isOnce=!0),null!=d&&(this.context=d),this._signal=a,e&&(this._priority=e),f&&f.length&&(this._args=f)},b.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,this._args&&(c=c.concat(this._args)),b=this._listener.apply(this.context,c),this.callCount++,this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Sfera.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},b.SignalBinding.prototype.constructor=b.SignalBinding;var c=function(){function a(){return{publicMethod:function(){consolthis.element.log("The public can see me!")},publicProperty:"I am also public"}}var b;return{getInstance:function(){return b||(b=a()),b}}}();c.getInstance();b.UI=new function(){var a,b;this.skipButtonEvents=!1,this.overEnabled=!0,this.buttonFeedbackEnabled=!0,this.setPressedButton=function(b){a=b},this.getPressedButton=function(){return a},this.updateLastButton=function(){b=a},this.getLastButton=function(){return b},this.liftButton=function(b){return!a||b&&b!=a?!1:(a.data.state&&(a.data.state="",a.updateClass()),a.onLift&&a.onLift(),a=null,!0)},this.resetButton=function(a){this.liftButton(a)||(a.data.state="",a.updateClass())}},b.UI.Button=function(a,b){this.element=a,this.element.btObj=this,this.initData(),b&&this.initEvents(b)},b.UI.Button.prototype={_attributes:{disabled:0,selected:1,pressed:2,checked:3,mini:4,error:5},initData:function(){var a=["light","stable","positive","calm","balanced","energized","assertive","royal","dark"],b=this.element.className,c="(.*\\s)?([mc][^\\s]*Button)(\\s("+a.join("|")+"))?(\\s.*)?(\\sover|\\sdown)?",d=new RegExp(c),e=d.exec(b);if(e&&e[2])var f={pre:e[1]?e[1]:"",bc:e[2],color:e[4]?e[4]:"",attrs:[],state:e[6]?e[6].substr(1):""};else var f={pre:b,bc:"",color:"",attrs:[],state:""};for(var g in this._attributes)f.attrs[this._attributes[g]]=e&&e[5]?-1!=e[5].indexOf(" "+g):!1;this.data=f,this.onLift=null,this.dontLiftOnMove=!1},initEvents:function(a){a.onclick&&(a.onup=a.onclick),b.Device.touch?(this.element.ontouchstart=this.onEvent.bind(this,"touchstart",a.ondown,null),this.element.ontouchmove=this.onEvent.bind(this,"touchmove",a.onmove,a.onout),this.element.ontouchstart=this.onEvent.bind(this,"touchend",a.onup,null)):(this.element.onmouseover=this.onEvent.bind(this,"mouseover",a.onover,null),this.element.onmouseout=this.onEvent.bind(this,"mouseout",a.onout,null),a.onmove&&(this.element.onmousemove=this.onEvent.bind(this,"mousemove",a.onmove,null)),this.element.onmousedown=this.onEvent.bind(this,"mousedown",a.ondown,null),this.element.onmouseup=this.onEvent.bind(this,"mouseup",a.onup,null)),a.onlift&&(this.onLift=a.onlift),a.dontLiftOnMove&&(this.dontLiftOnMove=!0)},clearEvents:function(){b.Device.touch?(delete this.element.ontouchstart,delete this.element.ontouchmove,delete this.element.ontouchend):(delete this.element.onmouseover,delete this.element.onmouseout,delete this.element.onmousedown,delete this.element.onmouseup)},setColor:function(a){this.data.color=a,this.updateClass()},enable:function(a){this.setAttribute(this.element,"disabled",!a)},select:function(a){this.setAttribute(this.element,"selected",a)},mini:function(a){this.setAttribute(this.element,"mini",a)},getAttribute:function(a){return this.data||this.initData(),this.data.attrs[this._attributes[a]]},setAttribute:function(a,b){this.getAttribute(a)!=b&&(this.data.attrs[this._attributes[a]]=b,this.updateClass())},updateClass:function(){var a=this.data,c=a.pre+a.bc;a.color&&(c+=" "+a.color);for(var d in this._attributes)a.attrs[this._attributes[d]]&&(c+=" "+d);b.UI.buttonFeedbackEnabled&&a.state&&(c+=" "+a.state),this.element.className=c},disableAndroidLongPress:function(a,b){if("Android"==browser.OS){for(var c=b;c;){if(c.getAttribute&&c.getAttribute("data-scrollmode"))return;c=c.parentNode}a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0,a.returnValue=!1}},preventDefault:function(a){a.returnValue&&(a.returnValue=!1),a.preventDefault&&a.preventDefault()},onEvent:function(a,c,d,e){if(!b.UI.skipButtonEvents){var f=window.event||e;if("touchstart"==a||"touchend"==a||"touchmove"==a){if(!b.Device.touch)return!1}else if(f&&this.preventDefault(f),b.Device.touch)return!1;this.data||this.initData();var g=this.data.attrs[this._attributes["switch"]],h=g?this.data.attrs[this._attributes.pressed]:!1,i=h,j="";if(!this.data.attrs[this._attributes.disabled])switch(a){case"touchstart":b.UI.setPressedButton(this),lastButton=null,touchStartX=f.touches[0].clientX,touchStartY=f.touches[0].clientY,j="down",g&&(i=!h),disableAndroidLongPress(f,this.element);break;case"touchmove":b.UI.getPressedButton()==this&&(j="down",!this.dontLiftOnMove&&(Math.abs(f.touches[0].clientX-touchStartX)>30||Math.abs(f.touches[0].clientY-touchStartY)>30)&&(b.UI.setPressedButton(null),c=d)),disableAndroidLongPress(f,this.element);break;case"touchend":b.UI.getPressedButton()!=this?c=null:(b.UI.updateLastButton(),this.preventDefault(f)),b.UI.setPressedButton(null),disableAndroidLongPress(f,this.element);break;case"mouseover":var k=b.UI.getPressedButton();k?k==this.element&&(j="down"):b.UI.overEnabled&&(j="over");break;case"mousemove":break;case"mouseout":var l;if(f&&(l=f.relatedTarget?f.relatedTarget:f.toElement),l){for(;l&&l!=this.element&&"BODY"!=l.nodeName;)l=l.parentNode;if(l==this.element)return}b.UI.setPressedButton(null);break;case"mousedown":b.UI.setPressedButton(this),lastButton=null,j="down",g&&(i=!h);break;case"mouseup":b.UI.getPressedButton()!=this?c=null:b.UI.updateLastButton(),b.UI.setPressedButton(null),b.UI.overEnabled&&(j="over")}if((j!=this.data.state||i!=h)&&(this.data.state=j,g&&(this.data.attrs[this._attributes.pressed]=i),this.updateClass()),c&&"null"!=c&&!this.data.attrs[this._attributes.disabled]){var m="string"==typeof c?new Function("event","this.element",c):c;m(e,this.element)}return!1}}},b.Net=function(a){function c(){return console.log(b.Utils.getDate("hisu")+" - opening socket on "+o),void 0!==i&&i.readyState!==WebSocket.CLOSED?void b.Debug.log(b.Utils.getDate()+" - websocket: is already opened."):(i=new WebSocket(o),i.onopen=function(a){void 0!==a.data&&(b.Debug.log(b.Utils.getDate("hisu")+" - websocket: open, sending subscribe",a.data),n.wsSend(b.urls.get("subscribe")))},i.onmessage=function(c){if(console.log(b.Utils.getDate("hisu")+" - received: "+c.data),"&"==c.data)d(),n.wsSend("&");else switch(b.Debug.log("websocket: onmessage",c.data),json=JSON.parse(c.data),json.type){case"reply":if(json&&json.result&&json.result.uiSet)for(var e in json.result.uiSet)for(var f=e.split("."),g=f.pop(),h=this.components.getObjsById(f.join(".")),i=0;i<h.length;i++)h[i].setAttribute(g,json.result.uiSet[e]);break;case"connection":j=parseInt(json.pingInterval),k=parseInt(json.responseTimeout),d();var l=(new Date).getTime(),o={action:"subscribe",nodes:"*",tag:l};n.wsSend(JSON.stringify(o)),m=!0;break;case"event":a.onEvent(json)}},i.onclose=function(a){b.Debug.log(b.Utils.getDate("hisu")+" - web socket: connection closed"),m=!1,c()},i.onerror=function(a){console.log("here",a)},void(i.onclose=function(a){var b;b=1e3==a.code?"Normal closure, meaning that the purpose for which the connection was established has been fulfilled.":1001==a.code?'An endpoint is "going away", such as a server going down or a browser having navigated away from a page.':1002==a.code?"An endpoint is terminating the connection due to a protocol error":1003==a.code?"An endpoint is terminating the connection because it has received a type of data it cannot accept (e.g., an endpoint that understands only text data MAY send this if it receives a binary message).":1004==a.code?"Reserved. The specific meaning might be defined in the future.":1005==a.code?"No status code was actually present.":1006==a.code?"The connection was closed abnormally, e.g., without sending or receiving a Close control frame":1007==a.code?"An endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [http://tools.ietf.org/html/rfc3629] data within a text message).":1008==a.code?'An endpoint is terminating the connection because it has received a message that "violates its policy". This reason is given either if there is no other sutible reason, or if there is a need to hide specific details about the policy.':1009==a.code?"An endpoint is terminating the connection because it has received a message that is too big for it to process.":1010==a.code?"An endpoint (client) is terminating the connection because it has expected the server to negotiate one or more extension, but the server didn't return them in the response message of the WebSocket handshake. <br /> Specifically, the extensions that are needed are: "+a.reason:1011==a.code?"A server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.":1015==a.code?"The connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified).":"Unknown reason",console.log(a.code,b)}))}function d(){clearTimeout(l),setTimeout(this.wsClose,j+k)}function e(){return(new Date).getTime()}function f(){console.log(q+" loaded"),b.Debug.log("xmlreq: loaded",h.getResponseText()),null!=n.localTs[q]&&(n.localTs[q]=e());var c;switch(q){case"dictionary":console.log("loaded dictionary"),a.onUpdateDictionary(h.getResponseXML());break;case"index":console.log("loaded index"),a.onUpdateIndex(h.getResponseXML());break;case"subscribe":n.subscribed=!0;case"state":c=JSON.parse(h.getResponseText()),c.id&&(config.clientId=c.id),c.timestamp&&(n.stateTs=c.timestamp)}n.sync()}function g(){console.log("error")}this.client=a;var h=new b.Net.Request;h.onLoaded=f,h.onError=g;var i,j,k,l,m=!1,n=this,o="",p="/";this.wsOpen=function(){c()},this.wsSend=function(a){console.log(b.Utils.getDate("hisu")+" - sending:  "+a),i.send(a)},this.wsClose=function(){i.close()};var q="",n=this;this.stateTs=-1,this.subscribed=!1,this.localTs={dictionary:-1,index:-1},this.remoteTs={dictionary:-1,index:-1},this.boot=function(){o=b.urls.get("websocket"),this.sync()},this.sync=function(){for(var a in this.localTs)if(-1==this.localTs[a])return q=a,void h.open(p+b.urls.get(a),20);return void c()},this.getHostName=function(){return window.location&&window.location.hostname?window.location.hostname:null},this.sendCommand=function(a){var b={action:"command",cmd:a.command,tag:a.tag};this.wsSend(JSON.stringify(b))},this.sendEvent=function(a){var b={action:"event",id:a.id,value:a.value,tag:a.tag};this.wsSend(JSON.stringify(b))}},b.Net.Request=function(){function a(){g&&(clearTimeout(g),g=null),d=-1,e.abort(),c(h.ERROR_MAXWAITTIME),h.init()}function b(){if(null!=e.readyState){switch(e.readyState){case 0:case 1:return;case 2:case 3:return;case 4:}if(g&&(clearTimeout(g),g=null),1==d){if(d=2,200!=e.status)return void c(h.ERROR_CONNECTION);var a="";try{a=e.responseText}catch(b){return void c(h.ERROR_GENERAL)}return 0==a.indexOf("authenticate")||0==a.indexOf("logout")?void c(h.ERROR_LOGOUT):0==a.indexOf("lock")?void c(h.ERROR_LOCK):"noaccess"==a?void c(h.ERROR_NOACCESS):void(h.onLoaded&&h.onLoaded(h))}}}function c(a){switch(a){case h.ERROR_CONNECTION:if(h.onConnectionError)return void h.onConnectionError();break;case h.ERROR_LOGOUT:if(h.onAuthenticate)return void h.onAuthenticate(!1);break;case h.ERROR_LOCK:if(h.onAuthenticate)return void h.onAuthenticate(!0);break;case h.ERROR_NOACCESS:if(h.onNoAccess)return void h.onNoAccess()}return h.retryOnErrorDelay&&(!h.maxRetries||h.retries<h.maxRetries)&&(h.retries++,h.onRetry&&h.onRetry(),h.retryOnErrorDelay)?void h.repeat(h.retryOnErrorDelay):void(h.onError&&h.onError(a))}var d,e=null,f=null;this.url="",this.onLoaded=null,this.onStop=null,this.onRetry=null,this.onError=null,this.onRequest=null,this.onConnectionError=null,this.onAuthenticate=null,this.onNoAccess=null,this.maxWaitingTime=0;var g=null;this.retryOnErrorDelay=0,this.maxRetries=0,this.retries=0;var h=this;this.ERROR_GENERAL=0,this.ERROR_CONNECTION=1,this.ERROR_MAXWAITTIME=2,this.ERROR_LOGOUT=3,this.ERROR_LOCK=4,this.ERROR_NOACCESS=5,this.init=function(){d=0,window.XMLHttpRequest?(e=new XMLHttpRequest,e.onreadystatechange=b):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP"),e&&(e.onreadystatechange=b))},this.open=function(b,i){if(1==d&&h.stop(),d=0,b&&(h.url=b,h.retries=0),f&&(clearTimeout(f),f=null),g&&(clearTimeout(g),g=null),i)return void(f=setTimeout(h.open,i));e||h.init(),d=1,h.onRequest&&h.onRequest();try{e.open("GET",h.url,!0)}catch(j){return void c(h.ERROR_GENERAL)}e.send(),h.maxWaitingTime&&(g=setTimeout(a,h.maxWaitingTime))},this.stop=function(){(1==d||f)&&this.onStop&&this.onStop(1==d),1==d&&(d=-1,e.abort(),this.init()),f&&(clearTimeout(f),f=null),g&&(clearTimeout(g),g=null),d=0},this.repeat=function(a){this.open(null,a)},this.getResponseJSON=function(){var a=this.getResponseText();return a?JSON.parse(a):null},this.getResponseText=function(){var a="";try{return a=e.responseText}catch(b){return null}},this.getResponseXML=function(){var a="";try{return a=e.responseXML}catch(b){return null}},this.isReady=function(){return 1!=d}},b.Skins=function(a){this.client=a},b.Browser=new function(){var a;this.reload=function(){window.location.reload()},this.changeUrl=function(a,b){if("undefined"!=typeof history.pushState){var c={Title:a,Url:b};return history.pushState(c,c.Title,c.Url),!0}return!1},this.updateUrl=function(a,b){var d=this.getLocation();if(hash="page:homepage"==a?"":a,document.title=b,d.hash!=hash){c=hash;var e=d.pathname+"#"+a;a&&d.search&&(e+="?"+d.search),this.changeUrl(b,e)}},this.getLocation=function(){var b=window.location.href;if(!a||a.url!=b){var c,d=window.location.hash,e=window.location.search;d&&("#"==d[0]&&(d=d.substr(1)),-1!=d.indexOf("?")&&(c=d.split("?"),d=c[0],e=c[1])),e&&("?"==e[0]&&(e=e.substr(1)),-1!=e.indexOf("#")&&(c=e.split("#"),e=c[0],d=c[1])),a={url:b,host:window.location.host,protocol:window.location.protocol,pathname:window.location.pathname,hash:d,search:e,"interface":window.location.pathname.split("/")[1]}}return a};var c=null;this.start=function(){setInterval(function(){var a=b.Browser.getLocation(),d="page:homepage"==a.hash?"":a.hash;d!==c&&(c=d,b.client.showPage(a.hash?a.hash:"homepage"))},100)}},b.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.desktop=!1,this.iOS=!1,this.cocoonJS=!1,this.cocoonJSApp=!1,this.cordova=!1,this.node=!1,this.nodeWebkit=!1,this.electron=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.canvasBitBltShift=null,this.webGL=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!0,this.quirksMode=!1,this.touch=!1,
this.mspointer=!1,this.wheelEvent=null,this.arora=!1,this.chrome=!1,this.chromeVersion=0,this.epiphany=!1,this.firefox=!1,this.firefoxVersion=0,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.oggVideo=!1,this.h264Video=!1,this.mp4Video=!1,this.webmVideo=!1,this.vp9Video=!1,this.hlsVideo=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1},b.Device=new b.Device,b.Device.onInitialized=new b.Signal,b.Device.whenReady=function(a,b,c){var d=this._readyCheck;if(this.deviceReadyAt||!d)a.call(b,this);else if(d._monitor||c)d._queue=d._queue||[],d._queue.push([a,b]);else{d._monitor=d.bind(this),d._queue=d._queue||[],d._queue.push([a,b]);var e="undefined"!=typeof window.cordova,f=navigator.isCocoonJS;"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(d._monitor,0):e&&!f?document.addEventListener("deviceready",d._monitor,!1):(document.addEventListener("DOMContentLoaded",d._monitor,!1),window.addEventListener("load",d._monitor,!1))}},b.Device._readyCheck=function(){var a=this._readyCheck;if(document.body){if(!this.deviceReadyAt){this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",a._monitor),document.removeEventListener("DOMContentLoaded",a._monitor),window.removeEventListener("load",a._monitor),this._initialize(),this.initialized=!0,this.onInitialized.dispatch(this);for(var b;b=a._queue.shift();){var c=b[0],d=b[1];c.call(d,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(a._monitor,20)},b.Device._initialize=function(){function a(){var a=navigator.userAgent;/Playstation Vita/.test(a)?i.vita=!0:/Kindle/.test(a)||/\bKF[A-Z][A-Z]+/.test(a)||/Silk.*Mobile Safari/.test(a)?i.kindle=!0:/Android/.test(a)?i.android=!0:/CrOS/.test(a)?i.chromeOS=!0:/iP[ao]d|iPhone/i.test(a)?i.iOS=!0:/Linux/.test(a)?i.linux=!0:/Mac OS/.test(a)?i.macOS=!0:/Windows/.test(a)&&(i.windows=!0),(/Windows Phone/i.test(a)||/IEMobile/i.test(a))&&(i.android=!1,i.iOS=!1,i.macOS=!1,i.windows=!0,i.windowsPhone=!0);var b=/Silk/.test(a);(i.windows||i.macOS||i.linux&&!b||i.chromeOS)&&(i.desktop=!0),(i.windowsPhone||/Windows NT/i.test(a)&&/Touch/i.test(a))&&(i.desktop=!1)}function b(){i.canvas=!!window.CanvasRenderingContext2D||i.cocoonJS;try{i.localStorage=!!localStorage.getItem}catch(a){i.localStorage=!1}i.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),i.fileSystem=!!window.requestFileSystem,i.webGL=function(){try{var a=document.createElement("canvas");return a.screencanvas=!1,!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}(),i.webGL=!!i.webGL,i.worker=!!window.Worker,i.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,i.quirksMode="CSS1Compat"===document.compatMode?!1:!0,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,i.getUserMedia=i.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,i.firefox&&i.firefoxVersion<21&&(i.getUserMedia=!1)}function c(){("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>=1)&&(i.touch=!0),(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(i.mspointer=!0),i.cocoonJS||("onwheel"in window||i.ie&&"WheelEvent"in window?i.wheelEvent="wheel":"onmousewheel"in window?i.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(i.wheelEvent="DOMMouseScroll"))}function d(){for(var a=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],b=document.createElement("div"),c=0;c<a.length;c++)if(b[a[c]]){i.fullscreen=!0,i.requestFullscreen=a[c];break}var d=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(i.fullscreen)for(var c=0;c<d.length;c++)if(document[d[c]]){i.cancelFullscreen=d[c];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(i.fullscreenKeyboard=!0)}function e(){var a=navigator.userAgent;if(/Arora/.test(a)?i.arora=!0:/Chrome\/(\d+)/.test(a)&&!i.windowsPhone?(i.chrome=!0,i.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(a)?i.epiphany=!0:/Firefox\D+(\d+)/.test(a)?(i.firefox=!0,i.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(a)&&i.iOS?i.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(a)?(i.ie=!0,i.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(a)?i.midori=!0:/Opera/.test(a)?i.opera=!0:/Safari/.test(a)&&!i.windowsPhone?i.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(a)&&(i.ie=!0,i.trident=!0,i.tridentVersion=parseInt(RegExp.$1,10),i.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(a)&&(i.silk=!0),navigator.standalone&&(i.webApp=!0),"undefined"!=typeof window.cordova&&(i.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(i.node=!0),i.node&&"object"==typeof process.versions&&(i.nodeWebkit=!!process.versions["node-webkit"],i.electron=!!process.versions.electron),navigator.isCocoonJS&&(i.cocoonJS=!0),i.cocoonJS)try{i.cocoonJSApp="undefined"!=typeof CocoonJS}catch(b){i.cocoonJSApp=!1}"undefined"!=typeof window.ejecta&&(i.ejecta=!0),/Crosswalk/.test(a)&&(i.crosswalk=!0)}function f(){var a=document.createElement("video"),b=!1;try{(b=!!a.canPlayType)&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(i.oggVideo=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(i.h264Video=!0,i.mp4Video=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(i.webmVideo=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(i.vp9Video=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(i.hlsVideo=!0))}catch(c){}}function g(){i.audioData=!!window.Audio,i.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var a=document.createElement("audio"),b=!1;try{(b=!!a.canPlayType)&&(a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(i.ogg=!0),(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))&&(i.opus=!0),a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(i.mp3=!0),a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(i.wav=!0),(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))&&(i.m4a=!0),a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(i.webm=!0))}catch(c){}}function h(){i.pixelRatio=window.devicePixelRatio||1,i.iPhone=-1!=navigator.userAgent.toLowerCase().indexOf("iphone"),i.iPhone4=2==i.pixelRatio&&i.iPhone,i.iPad=-1!=navigator.userAgent.toLowerCase().indexOf("ipad"),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(i.vibration=!0)}var i=this;a(),g(),f(),e(),h(),b(),d(),c()},b.Device.canPlayAudio=function(a){return"mp3"===a&&this.mp3?!0:"ogg"===a&&(this.ogg||this.opus)?!0:"m4a"===a&&this.m4a?!0:"opus"===a&&this.opus?!0:"wav"===a&&this.wav?!0:"webm"===a&&this.webm?!0:!1},b.Device.canPlayVideo=function(a){return"webm"===a&&(this.webmVideo||this.vp9Video)?!0:"mp4"===a&&(this.mp4Video||this.h264Video)?!0:"ogg"!==a&&"ogv"!==a||!this.oggVideo?"mpeg"===a&&this.hlsVideo?!0:!1:!0},b.Utils=function(){this.mixin=function(a,b){},this.extend=function(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.prototype.ancestor=b.prototype},this.initClass=function(a){a.prototype.constructor=a},this.getFirstChildNodeOfType=function(a,b){for(var c=0;c<a.childNodes.length;c++)if(a.childNodes[c].nodeType==b)return a.childNodes[c];return null},this.getCDATA=function(a){var b=this.getFirstChildNodeOfType(a,4);return b?b.nodeValue:""},this.isString=function(a){return"string"==typeof a||a instanceof String},this.camelToDash=function(a){return a.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()},this.dashToCamel=function(a){return a.toLowerCase().replace(/\W+(.)/g,function(a,b){return b.toUpperCase()})},this.getDate=function(a){function b(a,b){for(a+="",b||(b=2);a.length<b;)a="0"+a;return a}var c=new Date;a||(a="dmyhisu");for(var d={},e=0;e<a.length;e++)d[a[e]]=!0;var f="";return d.d&&(f+=b(c.getDate())),d.m&&(f+=(f?"/":"")+b(c.getMonth()+1)),d.y&&(f+=(f?"/":"")+c.getFullYear()),d.h&&(f+=(f?" ":"")+b(c.getHours())),d.i&&(f+=(f?":":"")+b(c.getMinutes())),d.s&&(f+=(f?":":"")+b(c.getSeconds())),d.u&&(f+=(f?":":"")+b(c.getMilliseconds(),3)),f}},b.Utils=new b.Utils,b.Components.create("_Base",{id:null,requireUpdate:null,children:[],attributes:{id:{type:"string",set:function(a){this.value.id=a,this.component.id=a,this.component.element.setAttribute("data-id",a)},get:function(){return this.attributeValues.id}}},init:function(){},getAttribute:function(a){return this.attributes[a]?this.attributes[a].get():void 0},setAttribute:function(a,b){this.attributes[a]&&this.attributes[a].set(b)},update:function(){},"super":function(a,c){b.Components[a].prototype[c].call(this)},setSource:function(a){this.processed=!1},addChild:function(a){this.children.push(a),a.parent=this,this.element&&this.element.appendChild(a.element)}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Sfera=b):"undefined"!=typeof define&&define.amd?define("Sfera",function(){return a.Sfera=b}()):a.Sfera=b}).call(this);