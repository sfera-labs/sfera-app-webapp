/*! sfera-webapp - v0.0.2 */

Sfera.Components.create("List",{presets:["Visibility","Position","Size","Style","Color","Enable"],attributes:{labels:{type:"list",update:function(){var a=this.component;a.redraw()}},values:{type:"list",update:function(){var a=this.component;a.redraw()}},template:{update:function(){var a,b=this.component,c=this.value;if(!c)return void(a=null);a={a:[],b:[]};for(var d,e,f=c.split("%"),g=0;g<f.length;g++)if(e=f[g],g){for(d=0;d<e.length&&isNumeric(e[d]);)d++;d?(a.a.push(e.substr(d)),a.b.push(e.substr(0,d))):a.a[a.a.length-1]+="%"+e}else a.a.push(e);b.template=a,b.redraw()}},onItemClick:{type:"js","default":"event(id,value)"}},init:function(){this.elements=Sfera.Utils.getComponentElements(this.element,!0,this.elements),this.buttons=[],this.setAttribute("template",'<div class="component comp_button" style="position:static">            <div name="bt" class="container style_default color_default">                <div class="cLabel" name="label">                %1                </div>            </div>        </div>'),this.updateClass()},updateClass:function(){for(var a=this.getAttribute("enabled")?"":" disabled",b=0;b<this.buttons.length;b++)this.buttons[b].setClassName("container"+a),this.buttons[b].enable(!a)},removeButtons:function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].destroy();this.buttons=[]},getItem:function(a){var b=this.getAttribute("values"),c=this.getAttribute("labels"),d=b&&null!=b[a]?b[a]:a+"",e=c&&null!=c[a]?c[a]:d;return[d,e]},getTotalItems:function(){var a=this.getAttribute("values"),b=this.getAttribute("labels");return a&&a.length&&(!b||a.length<=b.length)?a.length:b&&b.length?b.length:0},getItemHTML:function(a,b){var c=b[a],d='<div class="item';d+='" data-name="'+name+'" data-param="'+c[0]+'"';var e="";return d+=' style="'+e+'">',d+=this.applyTemplate(c[1])+"</div>"},initItemEvents:function(a){for(var b,c=this.elements.content.childNodes[a],d=c.getElementsByTagName("DIV"),e=0;e<d.length;e++)if("bt"==d[e].getAttribute("name")){b=d[e];break}b||(b=c),this.buttons[a]=new Sfera.UI.Button(b,{onclick:this.onItemClick.bind(this,a)}),this.getAttribute("enabled")||this.buttons[a].enable(!1)},onItemClick:function(a){var b=this.getItem(a),c=this.getAttribute("onItemClick");Sfera.Custom.exec(c,this.id,b[0])},updateItemContents:function(a){var b,c=this._items[a];b.innerHTML=this.applyTemplate(c[1])},applyTemplate:function(a){var b=a;if(b){if(this.template){var c,d=b.split("|");b="";for(var e=0;e<this.template.a.length;e++)b+=this.template.a[e],this.template.b.length>e&&(c=this.template.b[e]-1,b+=void 0!==d[c]?d[c]:"")}}else b="&nbsp;";return b},redraw:function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].lift();var b=this.getAttribute("values"),c=this.getAttribute("labels");if(!b&&!c)return void this.removeButtons();var a,d=this.getTotalItems(),e=[];for(a=0;d>a;a++)e.push(this.getItem(a));var f=0;rn=0;var g="";_items=[],this.removeButtons();for(a=0;d>a;a++)_items[a]=e[a],g+=this.getItemHTML(a,e),f++;this.elements.content.innerHTML=g;for(var h=this.elements.content.childNodes.length,a=0;h>a;a++)this.initItemEvents(a)}});