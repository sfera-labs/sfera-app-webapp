/*! sfera-webapp - v0.0.2 */


Sfera.Components.create("List",{presets:["Visibility","Position","Size","Style","Color","Enable"],attributes:{labels:{type:"list",update:function(){this.component.redraw()}},values:{type:"list",update:function(){this.component.redraw()}},template:{update:function(){var t,e=this.component,s=this.value;if(s){t={a:[],b:[]};for(var i,n,a=s.split("%"),l=0;l<a.length;l++)if(n=a[l],l){for(i=0;i<n.length&&isNumeric(n[i]);)i++;i?(t.a.push(n.substr(i)),t.b.push(n.substr(0,i))):t.a[t.a.length-1]+="%"+n}else t.a.push(n);e.template=t,e.redraw()}else t=null}},onItemClick:{type:"js",default:"event(id,value)"}},init:function(){this.elements=Sfera.Utils.getComponentElements(this.element,!0,this.elements),this.buttons=[],this.setAttribute("template",'<div class="component comp_button" style="position:static">            <div name="bt" class="container style_default color_default">                <div class="cLabel" name="label">                %1                </div>            </div>        </div>'),this.updateClass()},updateClass:function(){for(var t=this.getAttribute("enabled")?"":" disabled",e=0;e<this.buttons.length;e++)this.buttons[e].setClassName("container"+t),this.buttons[e].enable(!t)},removeButtons:function(){for(var t=0;t<this.buttons.length;t++)this.buttons[t].destroy();this.buttons=[]},getItem:function(t){var e=this.getAttribute("values"),s=this.getAttribute("labels"),i=e&&null!=e[t]?e[t]:t+"";return[i,s&&null!=s[t]?s[t]:i]},getTotalItems:function(){var t=this.getAttribute("values"),e=this.getAttribute("labels");return t&&t.length&&(!e||t.length<=e.length)?t.length:e&&e.length?e.length:0},getItemHTML:function(t,e){var s=e[t],i='<div class="item';i+='" data-name="'+name+'" data-param="'+s[0]+'"';return i+=' style="">',i+=this.applyTemplate(s[1])+"</div>"},initItemEvents:function(t){for(var e,s=this.elements.content.childNodes[t],i=s.getElementsByTagName("DIV"),n=0;n<i.length;n++)if("bt"==i[n].getAttribute("name")){e=i[n];break}e||(e=s),this.buttons[t]=new Sfera.UI.Button(e,{onclick:this.onItemClick.bind(this,t)}),this.getAttribute("enabled")||this.buttons[t].enable(!1)},onItemClick:function(t){var e=this.getItem(t),s=this.getAttribute("onItemClick");Sfera.Custom.exec(s,this.id,e[0])},updateItemContents:function(t){var e=this._items[t];(void 0).innerHTML=this.applyTemplate(e[1])},applyTemplate:function(t){var e=t;if(e){if(this.template){var s,i=e.split("|");e="";for(var n=0;n<this.template.a.length;n++)e+=this.template.a[n],this.template.b.length>n&&(e+=void 0!==i[s=this.template.b[n]-1]?i[s]:"")}}else e="&nbsp;";return e},redraw:function(){for(o=0;o<this.buttons.length;o++)this.buttons[o].lift();var t=this.getAttribute("values"),e=this.getAttribute("labels");if(t||e){var s=this.getTotalItems(),i=[];for(o=0;o<s;o++)i.push(this.getItem(o));var n=0;rn=0;var a="";_items=[],this.removeButtons();for(o=0;o<s;o++)_items[o]=i[o],a+=this.getItemHTML(o,i),n++;this.elements.content.innerHTML=a;for(var l=this.elements.content.childNodes.length,o=0;o<l;o++)this.initItemEvents(o)}else this.removeButtons()}});