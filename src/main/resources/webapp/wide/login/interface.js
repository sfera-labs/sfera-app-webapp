Sfera.Skins.Default=function(){this.VERSION="1.0";this.styles={Input:["default","clear"],Button:["default","clear","icon"],Checkbox:["default","radio","switch","clear"],Radio:["default"]};this.colors={Button:["default","light","stable","positive","calm","balanced","energized","assertive","royal","dark"]}};Sfera.Components.create("Button",{presets:["Visibility","Position","Size","Style","Color","Enable"],attributes:{label:{update:function(){var co=this.component;var label=co.subComponents.label;label.setAttribute("label",this.value);if(this.value){co.elements.label.style.display=""}else{co.elements.label.style.display="none"}}},icon:{type:"string","default":"",update:function(){var co=this.component;var icon=co.subComponents.icon;icon.setAttribute("source",this.value);if(this.value){co.elements.icon.style.display=""}else{co.elements.icon.style.display="none"}}},fontSize:{update:function(){var co=this.component;var label=co.subComponents.label;label.setAttribute("fontSize",this.value)}},onClick:{type:"js"},onDown:{type:"js"},onMove:{type:"js"}},init:function(){this.elements=Sfera.Utils.getComponentElements(this.element,true,this.elements);this.button=new Sfera.UI.Button(this.elements.container,{ondown:this.onDown.bind(this),onup:this.onUp.bind(this),onmove:this.onMove.bind(this)});this.updateClass()},updateClass:function(){var col=this.getAttribute("color")||"default";var sty=this.getAttribute("style")||"default";var d=this.getAttribute("enabled")?"":" disabled";this.button.setClassName("container"+(sty?" style_"+sty:"")+(col?" color_"+col:""))+d},onDown:function(){var f=this.getAttribute("onDown");Sfera.Custom.exec(f,this.id)},onMove:function(){var f=this.getAttribute("onMove");Sfera.Custom.exec(f,this.id)},onUp:function(){var f=this.getAttribute("onClick");Sfera.Custom.exec(f,this.id)}});Sfera.Components.create("Input",{"extends":"_Field",attributes:{type:{type:"string","default":"input",values:["input","textarea","color","date","datetime","email","number","password","tel","time","url"],update:function(){this.component.redraw()}},height:{update:function(){if(this.component.elements.field)this.component.elements.field.style.height=this.value+"px"}},focus:{type:"boolean",update:function(){if(this.value)this.component.focus()}},icon:{type:"string","default":"",update:function(){var co=this.component;var icon=co.subComponents.icon;icon.setAttribute("source",this.value);if(this.value){co.elements.icon.style.display=""}else{co.elements.icon.style.display="none"}}},eraseButton:{type:"boolean","default":"false",update:function(){var co=this.component;co.elements.erase.style.display=this.value?"":"none"}},value:{update:function(){if(this.component.elements.field)this.component.elements.field.value=this.value}},changeDelay:{type:"integer","default":"1000"},keyRegex:{type:"regexp"},valueRegex:{type:"regexp",compile:function(){this.value=Sfera.Compiler.compileAttributeValue(this,"^("+this.source+")$")}},fontSize:{type:"integer",update:function(){if(this.component.elements.field)this.component.elements.field.style.fontSize=this.value+"px"}},fontColor:{update:function(){if(this.component.elements.field)this.component.elements.field.style.color=this.value}},maxLength:{type:"integer"},onKeyUp:{type:"js"},onChange:{type:"js","default":"event(id,value)"},onEnterKey:{type:"js"},onFocus:{type:"js"},onBlur:{type:"js"}},init:function(){var self=this;this.value="";this.changeTimeout=null;this.elements=Sfera.Utils.getComponentElements(this.element,true,this.elements);this.eraseButton=new Sfera.UI.Button(this.elements.erase,{onclick:this.onErase.bind(this)})},focus:function(){this.elements.field.focus()},blur:function(){this.elements.field.blur()},redraw:function(){var value="";if(this.elements.field){this.elements.field.onfocus=null;this.elements.field.onblur=null;this.elements.field.onselectstart=null;value=this.elements.field.value;this.elements.field=null}var type=this.getAttribute("type");var phText=this.getAttribute("placeHolder");phText=phText?' placeholder="'+phText+'"':"";var style="";style=style?' style="'+style+'"':"";var d=this.getAttribute("enabled")?"":" disabled";if(type=="textarea")this.elements.fieldC.innerHTML='<textarea class="field" '+style+phText+d+" /></textarea>";else this.elements.fieldC.innerHTML='<input class="field" type="'+type+'"'+style+phText+d+' autocorrect="off" autocapitalize="off" />';this.elements.field=this.elements.fieldC.childNodes[0];this.elements.field.value=value;this.attributes.height.update();if(Sfera.Device.android=="Android"){this.elements.field.onfocus=function(){return false};this.elements.field.oninput=this.onUserChange}else{this.elements.field.onfocus=this.onFocus}this.elements.field.onblur=this.onBlur;this.elements.field.onselectstart=this.onSelectStart;this.elements.field.controller=this},updateClass:function(){var cl=this.getAttribute("cssClass");var f=this.focused?" focused":"";var d=this.getAttribute("enabled")?"":" disabled";this.element.className="component comp_input"+(cl?" "+cl:"")+f+d;var sty=this.getAttribute("style");this.elements.container.className="container"+(sty?" style_"+sty:"");if(this.elements.field){this.elements.field[(d?"set":"remove")+"Attribute"]("disabled")}},onErase:function(){if(!this.getAttribute("enabled"))return;this.setAttribute("value","");this.onChangedTimeout()},onChanged:function(){var v=this.elements.field.value;if(v!=this.attributes.value.source){this.attributes.value.source=this.attributes.value.value=v;this.clearChangeTimeout();var changeDelay=this.getAttribute("changeDelay");var self=this;if(changeDelay)this.changeTimeout=setTimeout(function(){self.onChangedTimeout()},changeDelay)}},clearChangeTimeout:function(){if(this.changeTimeout){clearTimeout(this.changeTimeout);this.changeTimeout=null}},onChangedTimeout:function(){this.clearChangeTimeout();var f=this.getAttribute("onChange");var value=this.getAttribute("value");Sfera.Custom.exec(f,this.id,value)},onSelectStart:function(event){},onKeyDown:function(event){if(!this.getAttribute("enabled"))return;var code=event.keyCode;var c=Sfera.Utils.getKeyFromCode(code);var type=this.getAttribute("type");if(c=="enter"&&!this.onEnterKey()){c=""}if(c=="enter"&&type!="textarea"||c=="tab"){this.onChangedTimeout();Sfera.client.focusNext(event.shiftKey);if(c=="enter"&&type!="textarea")this.blur();return false}else{this.onChanged();return true}},onKeyPress:function(event){if(!this.getAttribute("enabled"))return;var code=event.keyCode;var c=Sfera.Utils.getKeyFromCode(code);var fieldE=this.elements.field;var value=this.getAttribute("value");var keyRegex=this.getAttribute("keyRegex");var maxLength=this.getAttribute("maxLength");function getSelectedText(){var text="";if(fieldE.selectionStart!=fieldE.selectionEnd){text=value.substr(fieldE.selectionStart,fieldE.selectionEnd)}else if(typeof window.getSelection!="undefined"){text=window.getSelection().toString()}else if(typeof document.selection!="undefined"&&document.selection.type=="Text"){text=document.selection.createRange().text}return text}if(c.length==1){if(value&&maxLength&&value.length>=maxLength&&!getSelectedText()){return false}if(keyRegex&&!event.ctrlKey&&!event.metaKey&&!keyRegex.test(String.fromCharCode(code))){return false}}this.onChanged();return true},onKeyUp:function(event){if(!this.getAttribute("enabled"))return;var code=event.keyCode;var c=Sfera.Utils.getKeyFromCode(code);if(c!="enter"&&c!=="tab"){this.onChanged();return false}return true},onChange:function(){this.onChanged()},onEnterKey:function(){if(!this.getAttribute("enabled"))return;var f=this.getAttribute("onEnterKey");if(f){return Sfera.Custom.exec(f)}else{return true}},onFocus:function(){var co=this.controller;Sfera.client.setFocused(co);co.focused=true;co.updateClass()},onBlur:function(){var co=this.controller;co.onChanged();Sfera.client.clearFocused(co);co.focused=false;co.updateClass()},onShow:function(){if(this.getAttribute("focus"))this.focus()},onHide:function(){}});Sfera.Components.create("Image",{presets:["Visibility","Position","Size"],attributes:{source:{type:"string",update:function(){var c=this.component;var e=c.element;if(!this.value){e.innerHTML=""}else if(this.value.indexOf(".svg")==this.value.length-4){var req=new Sfera.Net.Request;req.init();req.onLoaded=function(){var xml=req.getResponseXML();var svg=xml.getElementsByTagName("svg")[0];e.innerHTML="";if(svg){e.appendChild(svg);svg.style.width=c.getAttribute("width");svg.style.height=c.getAttribute("height")}delete req};req.open(this.value)}else{e.innerHTML="<img src='"+this.value+"' width='100%' height='100%'>"}}}},init:function(){}});Sfera.Components.create("Page",{presets:["Visibility"],attributes:{title:{type:"string"},visible:{"default":"false"}},init:function(){}});Sfera.Components.create("Label",{presets:["Visibility","Position","Size","Label"],attributes:{label:null,text:{type:"string",update:function(){this.component.element.innerHTML=this.value}}}});Sfera.Components.create("Interface",{presets:["Visibility","Size"],attributes:{title:{type:"string"},skin:{"default":"default",update:function(){Sfera.client.skin=new(Sfera.Skins[Sfera.Utils.capitalize(this.value)])}},zoom:{type:"float",update:function(){if(this.value!=1){var bodyE=document.getElementsByTagName("BODY")[0];var v="scale("+this.value+","+this.value+")";if(Sfera.Device.browser=="IE"){bodyE.style.msTransform=v;bodyE.style.msTransformOrigin="0% 0%"}else{bodyE.style.zoom=this.value*100+"%";bodyE.style.OTransform=v;bodyE.style.MozTransform=v;bodyE.style.WebkitTransformOrigin="0 0";bodyE.style.transformOrigin="0% 0%"}bodyE.style.width="0px";bodyE.style.height="0px"}}}}});Sfera.Custom=new function(){var root=this;this.onReady=typeof onReady==="function"?function(){onReady()}:null;this.onEvent=typeof onEvent==="function"?function(id,value){return onEvent(id,value)}:null;this.onPage=typeof onPage==="function"?function(name){return onPage(id)}:null;function page(id){Sfera.client.showPage(id)}function event(id,value,callback){Sfera.client.sendEvent(id,value,callback)}function command(command,callback){Sfera.client.sendCommand(command,callback)}function logout(){Sfera.Login.logout()}function login(username,password){Sfera.Login.login(username,password)}function setAttribute(id,name,value){Sfera.client.setAttribute(id,name,value)}this.exec=function(f,id,value){try{var result=eval(f)}catch(e){if(e instanceof SyntaxError){alert(e.message)}else{throw e}}return result===false?false:true}};
//# sourceMappingURL=interface.js.map